export EDITOR=nvim

# fast node manager setup
eval "$(fnm env --use-on-cd --shell zsh)"

# set tig code editor as VSCode
export TIG_EDITOR="code --wait"

# history settings
export HISTFILE=~/.zsh_history
export HISTSIZE=10000
export SAVEHIST=100000
setopt EXTENDED_HISTORY
setopt INC_APPEND_HISTORY
setopt SHARE_HISTORY
setopt HIST_EXPIRE_DUPS_FIRST
setopt HIST_IGNORE_DUPS
setopt HIST_FIND_NO_DUPS
setopt HIST_IGNORE_SPACE
setopt HIST_SAVE_NO_DUPS
setopt HIST_REDUCE_BLANKS


if [[ $TERM_PROGRAM != "Warp.app" ]]; then
	# starship https://github.com/starship/starship
	eval "$(starship init zsh)"
	# vim mode
	bindkey -v
	bindkey -M viins jj vi-cmd-mode

	# aliases
	alias vim=nvim

	# zsh-autosuggestion (currently via homebrew)
	source $(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh

	# zsh-completion (currently via homebrew)
	if type brew &>/dev/null; then
		FPATH=$(brew --prefix)/share/zsh-completions:$FPATH
		# for my own additional commands
		fpath=(~/.zsh/completion "$fpath[@]")
		autoload -Uz compinit
		compinit
	fi

	func peco-command-history-reverse-search() {
		BUFFER=$(history -n -r 1 | peco --query "$LBUFFER")
		CURSOR="$#BUFFER"
	}
	func peco-command-history-search() {
		BUFFER=$(history -n 1 | peco --layout=top-down --query "$LBUFFER")
		CURSOR="$#BUFFER"
	}
	zle -N peco-command-history-search 
	zle -N peco-command-history-reverse-search 
	bindkey -M vicmd "?" peco-command-history-reverse-search
	bindkey -M vicmd "/" peco-command-history-search
	bindkey "<C-r>" peco-command-history-search
	# zsh-syntax-highlighting
	source /opt/homebrew/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
fi

if [ -f ~/.zshrc.local ]; then
	source ~/.zshrc.local
fi

